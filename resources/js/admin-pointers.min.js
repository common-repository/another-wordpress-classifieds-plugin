AWPCP.define("awpcp/pointers-manager",["jquery"],function(a){function e(){}return a.extend(e.prototype,{createPointers:function(e){var t=this;a.each(e,function(e,n){t.createPointer(n)})},createPointer:function(e){e.element=a("#wpadminbar").pointer({pointerClass:"wp-pointer awpcp-pointer",pointerWidth:470,position:e.position,content:e.content,buttons:this.createPointerButtons(e)}).pointer("open")},createPointerButtons:function(i){var o=this;return function(){var r=a("<div />");return a.each(i.buttons,function(e,n){var t=a("<a>");t.text(n.label),t.addClass(n.elementClass),t.css(n.elementCSS),t.on("click",function(e){o.onButtonClicked(e,n,i)}),r.append(t)}),r}},onButtonClicked:function(e,n,t){e.preventDefault(),(e=n.data&&n.data.slice?n.data.slice():[]).splice(0,0,n.event,t),a.publish("/pointer/"+n.event,e)}}),new e}),AWPCP.run("awpcp/admin-pointers",["jquery","awpcp/pointers-manager","awpcp/settings"],function(e,n,t){e(function(){var e=t.get("pointers");e&&n.createPointers(e)})}),AWPCP.run("awpcp/drip-autoresponder",["jquery","awpcp/pointers-manager","awpcp/settings"],function(p,s,c){p.subscribe("/pointer/awpcp-autoresponder-user-subscribed",function(e,n,t,r){var i=t.element.pointer("widget"),o=i.find(".awpcp-spinner").show(),a=i.find(".awpcp-message").empty().addClass("is-hidden");p.post(c.get("ajaxurl"),{action:n,email:i.find('[name="awpcp-user-email"]').val(),nonce:r},function(e){"ok"===e.status?(t.element.pointer("destroy"),s.createPointer(e.pointer)):"error"===e.status&&void 0!==e.error&&0<e.error.length?(a.removeClass("is-hidden").append(p("<p>"+e.error+"</p>")),o.hide()):t.element.pointer("destroy")})}),p.subscribe("/pointer/awpcp-autoresponder-dismissed",function(e,n,t,r){p.post(c.get("ajaxurl"),{action:n,nonce:r}),t.element.pointer("destroy")}),p.subscribe("/pointer/awpcp-autoresponder-confirmation-dismissed",function(e,n,t){t.element.pointer("destroy")})});